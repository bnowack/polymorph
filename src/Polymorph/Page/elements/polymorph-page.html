<!-- polymorph-page -->

<dom-module id="polymorph-page">
    <template>
        <style include="shared-styles">
            :host {
            }

            :host ::content {
            }
        </style>

        <content></content>
    </template>

    <script>
        Polymer({

            is: 'polymorph-page',

            properties: {
                /**
                 * View path of this partial
                 */
                path: {
                    type: String,
                    reflectToAttribute: true
                }
            },

            attached: function () {
                this.listen(document.body.querySelector('polymorph-app'), 'polymorph-page.loaded', 'onLoaded')
            },

            detached: function () {
                this.unlisten(document.body.querySelector('polymorph-app'), 'polymorph-page.loaded', 'onLoaded')
            },

            /**
             * Replaces the partial contents
             *
             * @param event Polymer event
             * @param data Event data with field `$partial`
             */
            onLoaded: function (event, data) {
                /** @type {HTMLElement} */
                var $partial = data.$partial;
                // update path property
                var path = $partial.getAttribute('path');// can't use $partial.path because the partial is not activated
                this.set('path', path);
                // replace all contents
                Polymer.dom(this).innerHTML = $partial.innerHTML;
            }

        });

    </script>

</dom-module>
